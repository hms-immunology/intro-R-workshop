---
title: "Data Visualization with ggplot2"
author: "R Workshop"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
    theme: united
    highlight: tango
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction to ggplot2

ggplot2 is a powerful data visualization package in R that implements the Grammar of Graphics. In this lesson, we'll learn how to create publication-quality plots for scientific data.

## Basic Plot Structure

A ggplot is built using layers:
1. Data
2. Aesthetics (mapping variables to visual properties)
3. Geometries (visual representations)
4. Statistics
5. Themes and customization

```{r basic_plot}
# Create sample data
gene_data <- tibble(
  gene_id = c("BRCA1", "TP53", "EGFR", "KRAS", "HER2"),
  expression = c(1543.7, 2345.2, 1234.5, 876.3, 2345.6),
  condition = rep(c("Control", "Treated"), length.out = 5)
)

# Create a basic plot
ggplot(gene_data, aes(x = gene_id, y = expression, fill = condition)) +
  geom_bar(stat = "identity", position = "dodge") +
  theme_minimal() +
  labs(
    title = "Gene Expression by Condition",
    x = "Gene",
    y = "Expression Level"
  )
```

## Common Plot Types for Biological Data

### 1. Scatter Plots
```{r scatter}
# Create sample data for scatter plot
expression_data <- tibble(
  control = rnorm(100, mean = 10, sd = 2),
  treated = rnorm(100, mean = 12, sd = 2)
)

ggplot(expression_data, aes(x = control, y = treated)) +
  geom_point(alpha = 0.6) +
  geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "red") +
  theme_minimal() +
  labs(
    title = "Expression Comparison: Control vs Treated",
    x = "Control Expression (log2)",
    y = "Treated Expression (log2)"
  )
```

### 2. Box Plots
```{r boxplot}
# Create sample data for box plot
long_data <- gene_data %>%
  pivot_longer(cols = expression, names_to = "measure", values_to = "value")

ggplot(long_data, aes(x = gene_id, y = value, fill = condition)) +
  geom_boxplot() +
  theme_minimal() +
  labs(
    title = "Gene Expression Distribution",
    x = "Gene",
    y = "Expression Level"
  )
```

### 3. Volcano Plots
```{r volcano}
# Create sample differential expression data
diff_expr <- tibble(
  gene = paste0("Gene", 1:1000),
  log2FC = rnorm(1000, mean = 0, sd = 1.5),
  pvalue = 10^(-runif(1000, 0, 5))
) %>%
  mutate(
    sig = pvalue < 0.05 & abs(log2FC) > 1,
    neglog10p = -log10(pvalue)
  )

ggplot(diff_expr, aes(x = log2FC, y = neglog10p)) +
  geom_point(aes(color = sig), alpha = 0.6) +
  scale_color_manual(values = c("grey", "red")) +
  theme_minimal() +
  labs(
    title = "Volcano Plot of Differential Expression",
    x = "Log2 Fold Change",
    y = "-Log10 P-value"
  )
```

## Customizing Plots

### Theme Customization
```{r theme}
# Create a custom theme
my_theme <- theme_minimal() +
  theme(
    plot.title = element_text(size = 14, face = "bold"),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10),
    legend.position = "bottom"
  )

# Apply custom theme
ggplot(gene_data, aes(x = gene_id, y = expression, fill = condition)) +
  geom_bar(stat = "identity", position = "dodge") +
  my_theme +
  scale_fill_brewer(palette = "Set2") +
  labs(
    title = "Gene Expression by Condition",
    x = "Gene",
    y = "Expression Level"
  )
```

## Practice Exercises

1. Create a scatter plot with marginal distributions
2. Make a heatmap of gene expression data
3. Create a custom visualization combining multiple plot types

## Next Steps

After this lesson, you can:
- Create complex, multi-panel figures
- Customize plots for publication
- Export high-resolution images
- Create interactive visualizations 